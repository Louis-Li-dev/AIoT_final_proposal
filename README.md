# æ–‡ä»¶è½‰ HTML å°å·¥å…· ğŸ“„â¡ï¸ğŸŒ

**ç°¡ä»‹**

é€™æ˜¯ä¸€å€‹ä½¿ç”¨ Python/Flask é–‹ç™¼çš„è¼•é‡å·¥å…·ï¼Œç”¨æ–¼æŠŠä½¿ç”¨è€…æä¾›çš„æ®µè½èˆ‡å€å¡Šï¼ˆå«åœ–ç‰‡ï¼‰è½‰æ›æˆéœæ…‹ HTML æ–‡ä»¶ï¼Œä¸¦æä¾›ä¸€äº›è¼”åŠ©åŠŸèƒ½ï¼ˆå¦‚æ–‡å­—é‡å¯«ï¼å„ªåŒ–èˆ‡ HTML å¾®èª¿ï¼‰ï¼ŒåŒæ™‚æ”¯æ´å°‡ local ä¸Šå‚³çš„åœ–ç‰‡åµŒå…¥è¼¸å‡ºçš„ HTMLï¼ˆBase64 ç·¨ç¢¼ï¼‰ã€‚

---

## âœ… åŠŸèƒ½äº®é»

- ä»¥ JSON æ ¼å¼æ¥æ”¶æ–‡ä»¶çµæ§‹ï¼Œè¼¸å‡ºå®Œæ•´ HTMLï¼ˆæ”¯æŒå¤šç¨®æ¨¡æ¿ï¼Œé è¨­ç‚º `nctu`ï¼‰ã€‚
- åœ–ç‰‡ä¸Šå‚³èˆ‡è‡ªå‹•è½‰ç‚º Base64 åµŒå…¥è¼¸å‡º HTMLï¼ˆæ”¯æ´ `/static/uploads/` çš„åœ–ç‰‡ï¼‰ã€‚
- èˆ‡ Google Geminiï¼ˆgoogle-generativeaiï¼‰æ•´åˆï¼š
  - æ–‡å­—é‡å¯«ï¼ˆ`/api/rephrase`ï¼‰
  - HTML å¾®èª¿ï¼ˆ`/api/fix-html`ï¼‰
- Web UIï¼šä¸»é  `GET /` æä¾›ç°¡å–®ä»‹é¢ï¼ˆè‹¥æœ‰å‰ç«¯æ¨¡æ¿ï¼‰ã€‚

---

## å°ˆæ¡ˆçµæ§‹ï¼ˆé‡è¦æª”æ¡ˆï¼‰

- `app.py` - Flask æ‡‰ç”¨èˆ‡ API å¯¦ä½œ
- `template_strings/` - HTML ç”¢ç”Ÿå™¨æ¨¡æ¿ï¼ˆ`nctu`, `academic` ç­‰ï¼‰
- `static/uploads/` - åœ–ç‰‡ä¸Šå‚³æš«å­˜ç›®éŒ„
- `output/document.html` - ç¯„ä¾‹è¼¸å‡ºæª”æ¡ˆä½ç½®ï¼ˆç”± API ç”¢ç”Ÿï¼‰
- `requirements.txt` - ç¬¬ä¸‰æ–¹å¥—ä»¶æ¸…å–®
- `ai_development_log.html` - å·²ç”Ÿæˆçš„é–‹ç™¼å°è©±ç´€éŒ„ï¼ˆå¯ç›´æ¥äº¤è€å¸«ï¼‰

---

## å¿«é€Ÿä¸Šæ‰‹ï¼ˆæœ¬æ©Ÿé–‹ç™¼ï¼‰

1. å»ºè­°ä½¿ç”¨ Python 3.10/3.11 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚

2. å»ºç«‹ä¸¦å•Ÿå‹•è™›æ“¬ç’°å¢ƒï¼š

```bash
python -m venv .venv
# Windows
.\.venv\Scripts\activate
# macOS / Linux
source .venv/bin/activate
```

3. å®‰è£ä¾è³´ï¼š

```bash
pip install -r requirements.txt
```

4. å•Ÿå‹•æ‡‰ç”¨ï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰ï¼š

```bash
python app.py
# é è¨­ç›£è½ http://127.0.0.1:5000
```

> âš ï¸ è‹¥è¦å°æ¥ Google Gemini APIï¼Œè«‹æº–å‚™å¥½ API Keyï¼ˆä¸è¦åœ¨å…¬é–‹ repo æä¾›æˆ–ç¡¬ç·¨ç¢¼ï¼‰ã€‚

---

## API ä»‹é¢ï¼ˆç¯„ä¾‹ï¼‰

### 1) GET /

- åŠŸèƒ½ï¼šè¼‰å…¥å‰ç«¯ UIï¼ˆè‹¥æœ‰ï¼‰ã€‚

### 2) POST /api/generate-document

- åŠŸèƒ½ï¼šä»¥ JSON çš„ `sections`ï¼ˆé™£åˆ—ï¼‰èˆ‡ `formatting` ç­‰åƒæ•¸ç”Ÿæˆå®Œæ•´ HTMLã€‚
- ç¯„ä¾‹ï¼š

```bash
curl -X POST http://127.0.0.1:5000/api/generate-document \
  -H "Content-Type: application/json" \
  -d '{"sections": [{"title":"ç¯„ä¾‹","blocks":[{"type":"text","content":"Hello"}]}], "template":"nctu"}'
```

- å›å‚³ï¼šJSONï¼ŒåŒ…å« `success` èˆ‡ `html`ï¼ˆå®Œæ•´ HTML å­—ä¸²ï¼‰ã€‚

### 3) POST /api/fix-html

- åŠŸèƒ½ï¼šå‘¼å« Gemini ä¾†å¾®èª¿ HTMLï¼ˆåƒ…å›å‚³ `<body>` å…§çš„ raw HTMLï¼‰ã€‚
- éœ€æ±‚ï¼š`html`ï¼ˆå­—ä¸²ï¼‰ã€`api_key`ï¼ˆå­—ä¸²ï¼‰ã€å¯é¸ `instruction`ã€‚
- ç¯„ä¾‹ï¼š

```bash
curl -X POST http://127.0.0.1:5000/api/fix-html \
  -H "Content-Type: application/json" \
  -d '{"html":"<div class=\"page\"> ...</div>", "api_key":"YOUR_KEY"}'
```

### 4) POST /api/rephrase

- åŠŸèƒ½ï¼šä½¿ç”¨ Gemini é‡å¯«æˆ–æ½¤é£¾æ–‡å­—ï¼ˆåƒ…å›å‚³é‡å¯«å¾Œçš„æ–‡å­—ï¼‰ã€‚
- éœ€æ±‚ï¼š`text`ã€`api_key`ã€‚

### 5) POST /api/upload-image

- åŠŸèƒ½ï¼šä¸Šå‚³åœ–ç‰‡ï¼ˆmultipart/form-data, key= `image`ï¼‰ï¼Œå›å‚³ `{"url":"/static/uploads/<filename>"}`ã€‚

```bash
curl -X POST http://127.0.0.1:5000/api/upload-image \
  -F "image=@./photo.jpg"
```

---

## é–‹ç™¼è€…å‚™è¨» ğŸ”§

- ä¸Šå‚³æª”æ¡ˆå­˜æ”¾æ–¼ `static/uploads/`ï¼›ç”¢å‡ºæª”æ¡ˆä½æ–¼ `output/`ã€‚
- è‹¥ç”¢ç”Ÿ HTML ä¸­è¦åŒ…å«æœ¬åœ°åœ–æª”ï¼Œç³»çµ±æœƒå˜—è©¦æŠŠæª”æ¡ˆè½‰ç‚º Base64 ä¸¦åµŒå…¥ï¼Œé¿å…å¤–éƒ¨ç›¸ä¾ã€‚
- åœ¨ç¨‹å¼ä¸­ä½¿ç”¨ `genai.configure(api_key=...)` å‹•æ…‹å‚³å…¥é‡‘é‘°ï¼ŒAPI Key ä¸æœƒå¾ç’°å¢ƒè‡ªå‹•è®€å–ï¼ˆç›®å‰ç‚ºå‘¼å«æ™‚å‚³é€ï¼‰ã€‚
- Gemini model ä½¿ç”¨ï¼š`gemini-2.5-flash`ï¼ˆæ³¨æ„ï¼šä½¿ç”¨æ™‚æœƒç”¢ç”Ÿé›²ç«¯è²»ç”¨ï¼Œè«‹ç•™æ„å¸³å–®èˆ‡ä½¿ç”¨é™åˆ¶ï¼‰ã€‚

---

## ç¯„ä¾‹ï¼šä½¿ç”¨ Python å‘¼å« `generate-document`

```python
import requests
url = 'http://127.0.0.1:5000/api/generate-document'
data = {
  'sections': [
    {'title': 'å°é¢', 'blocks': [{'type': 'text', 'content': 'æˆ‘çš„å ±å‘Š'}]}
  ],
  'template': 'nctu'
}
res = requests.post(url, json=data)
print(res.json().get('html')[:200])
```

---

## æ¸¬è©¦èˆ‡éƒ¨ç½²å»ºè­°

- æœ¬å°ˆæ¡ˆé©åˆéƒ¨ç½²åœ¨å…·å‚™ Python ç’°å¢ƒçš„ä¸»æ©Ÿæˆ–å®¹å™¨ä¸­ï¼ˆDocker/Gunicorn + Nginxï¼‰ã€‚
- å¦‚åœ¨ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨ Geminiï¼Œè«‹ç”¨å®‰å…¨æ–¹å¼ç®¡ç† API Keyï¼ˆä¾‹å¦‚ä½¿ç”¨ç’°å¢ƒè®Šæ•¸æˆ– Secret Managerï¼‰ã€‚

---

## è¯çµ¡ / æˆæ¬Š

å¦‚æœéœ€è¦æˆ‘å¹«ä½ ï¼š
- æŠŠ README ç¿»æˆè‹±æ–‡
- åŠ å…¥æ›´è©³ç´°çš„ API æ–‡ä»¶ï¼ˆOpenAPI/Swaggerï¼‰
- æ–°å¢éƒ¨ç½² Dockerfile æˆ– CI è¨­å®š

æ­¡è¿å‘Šè¨´æˆ‘ä½ æƒ³è¦çš„ç´°ç¯€ï¼ğŸ¯

---

*Generated by GitHub Copilot (Raptor mini - Preview)*
